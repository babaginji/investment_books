<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>{{ shelf_name }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>{{ shelf_name }}</h1>

    <!-- 棚の本 -->
    <div class="books-container" id="books-container">
        {% for book in books %}
        <div class="book">
            <span class="star" onclick="addToMyShelf('{{ book.title|escape }}', '{{ book.author|escape }}', '{{ book.price }}', '{{ book.image|escape }}', '{{ book.itemUrl|escape }}')">★</span>
            <a href="{{ book.itemUrl }}" target="_blank">
                <img src="{{ book.image }}" alt="{{ book.title }}">
            </a>
            <h3>{{ book.title }}</h3>
            <p>著者: {{ book.author }}</p>
            <p>価格: ¥{{ book.price }}</p>
        </div>
        {% endfor %}
    </div>

    <p><a href="{{ url_for('index') }}">トップに戻る</a></p>

    <script>
    // -----------------------------
    // 星クリックで「私の本棚」に追加
    // -----------------------------
    function addToMyShelf(title, author, price, image, itemUrl) {
        const book = { title, author, price, image, itemUrl };
        fetch('/add_to_my_shelf', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ book })
        })
        .then(res => res.json())
        .then(data => {
            alert(`「${title}」を私の本棚に追加しました`);
        })
        .catch(err => console.error(err));
    }
    </script>
</body>
</html>
